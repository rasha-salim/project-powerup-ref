<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Intelligent Project Planning System - Interactive Architecture</title>
    <meta name="description" content="Interactive 2D visualization of an AI-powered project planning system architecture showing components, data flow, and relationships.">
    <meta name="keywords" content="AI, project planning, system architecture, visualization, interactive diagram">
    <meta name="author" content="Your Name">
    
    <!-- Open Graph Meta Tags for better sharing -->
    <meta property="og:title" content="Intelligent Project Planning System Architecture">
    <meta property="og:description" content="Interactive visualization showing how AI agents collaborate in our project planning system">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://yourusername.github.io/your-repo-name">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Intelligent Project Planning System">
    <meta name="twitter:description" content="Interactive AI system architecture visualization">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
            color: white;
            overflow: hidden;
            height: 100vh;
        }

        #canvas {
            border: none;
            cursor: crosshair;
            background: transparent;
        }

        .controls {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 12px;
            padding: 20px;
            max-width: 300px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            z-index: 100;
            transition: all 0.3s ease;
        }

        .controls.collapsed {
            padding: 12px;
            max-width: 60px;
        }

        .controls.collapsed .controls-content {
            display: none;
        }

        .controls-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .collapse-btn {
            background: rgba(59, 130, 246, 0.2);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 4px;
            color: #3b82f6;
            cursor: pointer;
            padding: 4px 8px;
            font-size: 12px;
            transition: all 0.2s ease;
        }

        .collapse-btn:hover {
            background: rgba(59, 130, 246, 0.3);
        }

        .controls h3 {
            color: #3b82f6;
            margin-bottom: 10px;
            font-size: 18px;
        }

        .controls p {
            color: #94a3b8;
            font-size: 12px;
            margin-bottom: 15px;
            line-height: 1.4;
        }

        .button-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 15px;
        }

        .controls-help {
            margin-top: 10px;
            font-size: 10px;
            color: #64748b;
            line-height: 1.3;
        }

        .controls-help div {
            margin-bottom: 2px;
        }

        button {
            background: linear-gradient(45deg, #3b82f6, #1d4ed8);
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            color: white;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
            border: 1px solid rgba(59, 130, 246, 0.3);
        }

        button:hover {
            background: linear-gradient(45deg, #1d4ed8, #1e40af);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        .legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 12px;
            padding: 20px;
            max-width: 250px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            z-index: 100;
            transition: all 0.3s ease;
        }

        .legend.collapsed {
            padding: 12px;
            max-width: 60px;
        }

        .legend.collapsed .legend-content {
            display: none;
        }

        .legend-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .legend h4 {
            color: #3b82f6;
            margin-bottom: 12px;
            font-size: 16px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            font-size: 12px;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .info-panel {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 12px;
            padding: 20px;
            max-width: 400px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
            z-index: 100;
        }

        .info-panel.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .info-panel.collapsed {
            max-width: 200px;
            padding: 12px;
        }

        .info-panel.collapsed .info-content {
            display: none;
        }

        .info-panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .info-panel h4 {
            color: #3b82f6;
            margin-bottom: 8px;
            font-size: 16px;
        }

        .info-panel .layer {
            color: #fbbf24;
            font-size: 12px;
            margin-bottom: 8px;
        }

        .info-panel p {
            color: #e2e8f0;
            font-size: 13px;
            line-height: 1.4;
        }

        .floating-particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: rgba(59, 130, 246, 0.6);
            border-radius: 50%;
            animation: float 20s infinite linear;
        }

        @keyframes float {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) rotate(360deg);
                opacity: 0;
            }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.1);
            }
        }

        .stats {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 12px;
            padding: 15px;
            font-size: 12px;
            color: #94a3b8;
            z-index: 100;
        }

        .github-link {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(34, 197, 94, 0.3);
            border-radius: 8px;
            padding: 8px 16px;
            font-size: 12px;
            color: #22c55e;
            text-decoration: none;
            transition: all 0.3s ease;
            z-index: 100;
        }

        .github-link:hover {
            background: rgba(34, 197, 94, 0.1);
            transform: translateX(-50%) translateY(-2px);
            box-shadow: 0 4px 12px rgba(34, 197, 94, 0.3);
        }

        /* Mobile responsiveness */
        @media (max-width: 768px) {
            .controls, .legend {
                max-width: 250px;
                padding: 15px;
            }
            
            .controls.collapsed, .legend.collapsed {
                max-width: 50px;
                padding: 8px;
            }
            
            .controls h3, .legend h4 {
                font-size: 14px;
            }
            
            .info-panel {
                max-width: 300px;
                padding: 15px;
            }
            
            .info-panel.collapsed {
                max-width: 150px;
                padding: 8px;
            }
            
            .github-link {
                position: static;
                transform: none;
                margin: 10px auto;
                display: block;
                text-align: center;
                width: fit-content;
            }
        }
    </style>
</head>
<body>
    <div class="floating-particles" id="particles"></div>
    
    <canvas id="canvas"></canvas>
    
    <!-- GitHub Repository Link -->
    <a href="https://github.com/yourusername/your-repo-name" class="github-link" target="_blank">
        ⭐ View on GitHub
    </a>
    
    <div class="controls" id="controlsPanel">
        <div class="controls-header">
            <h3>🚀 System Controls</h3>
            <button class="collapse-btn" onclick="toggleControls()">−</button>
        </div>
        <div class="controls-content">
            <p>Explore the intelligent project planning system architecture</p>
            <div class="button-group">
                <button onclick="toggleAnimation()">Toggle Animation</button>
                <button onclick="resetLayout()">Reset View</button>
                <button onclick="toggleDataFlow()">Show Data Flow</button>
                <button onclick="focusLayer()">Focus AI Agents</button>
                <button onclick="zoomIn()">Zoom In (+)</button>
                <button onclick="zoomOut()">Zoom Out (-)</button>
            </div>
            <div class="controls-help">
                <div>🖱️ Click & drag to pan</div>
                <div>🎯 Click nodes for details</div>
                <div>🔍 Mouse wheel to zoom</div>
                <div>⌨️ Arrow keys or WASD to move</div>
                <div>🔑 +/- to zoom, R to reset</div>
            </div>
        </div>
    </div>

    <div class="legend" id="legendPanel">
        <div class="legend-header">
            <h4>🎯 System Layers</h4>
            <button class="collapse-btn" onclick="toggleLegend()">−</button>
        </div>
        <div class="legend-content">
            <div class="legend-item">
                <div class="legend-color" style="background: #3b82f6;"></div>
                <span>Frontend Layer</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #f59e0b;"></div>
                <span>API Layer</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #8b5cf6;"></div>
                <span>AI Agents</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #06b6d4;"></div>
                <span>Processing</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #0369a1;"></div>
                <span>Database</span>
            </div>
        </div>
    </div>

    <div class="info-panel" id="infoPanel">
        <div class="info-panel-header">
            <h4 id="componentName">Select a component</h4>
            <button class="collapse-btn" onclick="toggleInfo()" style="display: none;" id="infoCollapseBtn">−</button>
        </div>
        <div class="info-content">
            <div class="layer" id="componentLayer"></div>
            <p id="componentDescription">Click on any node to learn more about that component.</p>
        </div>
    </div>

    <div class="stats" id="stats">
        <div>Components: <span id="nodeCount">0</span></div>
        <div>Connections: <span id="connectionCount">0</span></div>
        <div>Active Flows: <span id="flowCount">0</span></div>
    </div>

    <script>
        // Canvas setup
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        // Viewport and camera settings
        let camera = { x: 0, y: 0, zoom: 1 };
        let isDragging = false;
        let lastMouseX = 0;
        let lastMouseY = 0;

        // System components data (centered around origin)
        const components = [
            // Frontend Layer
            { id: 'nextjs', name: 'Next.js Frontend', x: 0, y: -300, layer: 'Frontend', color: '#3b82f6', size: 25, description: 'User interface built with Next.js and React. Provides interactive dashboard and chat interface for seamless human-AI collaboration.' },
            { id: 'dashboard', name: 'Dashboard', x: -150, y: -250, layer: 'Frontend', color: '#06b6d4', size: 20, description: 'Interactive visualizations and charts showing project insights, analytics, and real-time agent collaboration results.' },
            { id: 'chat', name: 'Chat Interface', x: 150, y: -250, layer: 'Frontend', color: '#10b981', size: 20, description: 'Real-time chat interface enabling natural dialogue between humans and AI agents during project analysis.' },

            // API Layer
            { id: 'fastapi', name: 'FastAPI', x: 0, y: -150, layer: 'API', color: '#f59e0b', size: 30, description: 'Async Python API framework handling requests, coordinating AI agents, and managing system orchestration.' },
            { id: 'websockets', name: 'WebSockets', x: 200, y: -150, layer: 'API', color: '#ec4899', size: 22, description: 'Real-time communication channel enabling live agent conversations and instant updates to users.' },

            // AI Agents Layer
            { id: 'technical', name: 'Technical Agent', x: -150, y: -50, layer: 'AI Agents', color: '#8b5cf6', size: 28, description: 'Specialized AI agent analyzing technical architecture, technology stack choices, and project feasibility assessments.' },
            { id: 'risk', name: 'Risk Agent', x: 0, y: -50, layer: 'AI Agents', color: '#ef4444', size: 28, description: 'Expert AI agent identifying potential risks, challenges, dependencies, and comprehensive mitigation strategies.' },
            { id: 'planning', name: 'Planning Agent', x: 150, y: -50, layer: 'AI Agents', color: '#84cc16', size: 28, description: 'Strategic AI agent creating detailed roadmaps, realistic timelines, and optimal resource allocation plans.' },
            { id: 'crewai', name: 'CrewAI', x: 0, y: 0, layer: 'AI Agents', color: '#f97316', size: 24, description: 'Advanced framework orchestrating seamless AI agent collaboration, task coordination, and intelligent workflow management.' },

            // Processing Layer
            { id: 'claude', name: 'Claude LLM', x: 0, y: 100, layer: 'Processing', color: '#6366f1', size: 32, description: 'Anthropic Claude 3 Haiku providing the core intelligence powering all AI agent reasoning, analysis, and decision-making.' },
            { id: 'docprocessing', name: 'Document Processing', x: -200, y: 100, layer: 'Processing', color: '#14b8a6', size: 20, description: 'Advanced pipeline processing project briefs, meeting transcripts, uploaded documents, and extracting actionable insights.' },
            { id: 'yamlconfig', name: 'YAML Config', x: 200, y: 100, layer: 'Processing', color: '#a855f7', size: 18, description: 'Configuration-driven architecture enabling easy modification of agent behaviors, tasks, and system parameters without code changes.' },

            // Database Layer
            { id: 'postgresql', name: 'PostgreSQL', x: -100, y: 200, layer: 'Database', color: '#0369a1', size: 26, description: 'Robust relational database storing structured project data, user information, session history, and system analytics.' },
            { id: 'chromadb', name: 'ChromaDB', x: 100, y: 200, layer: 'Database', color: '#dc2626', size: 24, description: 'Advanced vector database enabling semantic search, document embeddings, and intelligent content retrieval capabilities.' },
            { id: 'filestorage', name: 'File Storage', x: 0, y: 250, layer: 'Database', color: '#059669', size: 22, description: 'Secure, scalable file storage system for uploaded documents, generated reports, and persistent data management.' }
        ];

        // Connections between components
        const connections = [
            { from: 'nextjs', to: 'fastapi', type: 'api' },
            { from: 'dashboard', to: 'fastapi', type: 'data' },
            { from: 'chat', to: 'websockets', type: 'realtime' },
            { from: 'websockets', to: 'fastapi', type: 'api' },
            
            { from: 'fastapi', to: 'technical', type: 'control' },
            { from: 'fastapi', to: 'risk', type: 'control' },
            { from: 'fastapi', to: 'planning', type: 'control' },
            { from: 'fastapi', to: 'crewai', type: 'orchestration' },
            
            { from: 'technical', to: 'claude', type: 'processing' },
            { from: 'risk', to: 'claude', type: 'processing' },
            { from: 'planning', to: 'claude', type: 'processing' },
            { from: 'crewai', to: 'yamlconfig', type: 'config' },
            
            { from: 'claude', to: 'postgresql', type: 'data' },
            { from: 'claude', to: 'chromadb', type: 'vector' },
            { from: 'docprocessing', to: 'chromadb', type: 'embedding' },
            { from: 'docprocessing', to: 'filestorage', type: 'storage' }
        ];

        // Animation state
        let animationActive = true;
        let showDataFlow = false;
        let frameCount = 0;
        let selectedComponent = null;

        // Create floating background particles
        function createBackgroundParticles() {
            const particleContainer = document.getElementById('particles');
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 20 + 's';
                particle.style.animationDuration = (15 + Math.random() * 10) + 's';
                particleContainer.appendChild(particle);
            }
        }

        // Get component by ID
        function getComponent(id) {
            return components.find(comp => comp.id === id);
        }

        // Draw connection line
        function drawConnection(from, to, type, animated = false) {
            const fromComp = getComponent(from);
            const toComp = getComponent(to);
            if (!fromComp || !toComp) return;

            ctx.save();
            
            // Apply camera transformation
            const fromX = (fromComp.x - camera.x) * camera.zoom + canvas.width / 2;
            const fromY = (fromComp.y - camera.y) * camera.zoom + canvas.height / 2;
            const toX = (toComp.x - camera.x) * camera.zoom + canvas.width / 2;
            const toY = (toComp.y - camera.y) * camera.zoom + canvas.height / 2;
            
            // Connection styling based on type
            const styles = {
                api: { color: '#3b82f6', width: 2 },
                data: { color: '#10b981', width: 3 },
                realtime: { color: '#ec4899', width: 4 },
                control: { color: '#f59e0b', width: 2 },
                orchestration: { color: '#8b5cf6', width: 3 },
                processing: { color: '#6366f1', width: 2 },
                config: { color: '#a855f7', width: 2 },
                vector: { color: '#dc2626', width: 2 },
                embedding: { color: '#14b8a6', width: 2 },
                storage: { color: '#059669', width: 2 }
            };

            const style = styles[type] || { color: '#64748b', width: 1 };
            
            if (animated && showDataFlow) {
                // Animated data flow effect
                const gradient = ctx.createLinearGradient(fromX, fromY, toX, toY);
                const offset = (frameCount * 0.05) % 1;
                gradient.addColorStop(0, 'transparent');
                gradient.addColorStop(Math.max(0, offset - 0.1), 'transparent');
                gradient.addColorStop(offset, style.color);
                gradient.addColorStop(Math.min(1, offset + 0.1), 'transparent');
                gradient.addColorStop(1, 'transparent');
                ctx.strokeStyle = gradient;
                ctx.lineWidth = (style.width + 2) * camera.zoom;
            } else {
                ctx.strokeStyle = style.color + (showDataFlow ? 'ff' : '60');
                ctx.lineWidth = style.width * camera.zoom;
            }

            ctx.beginPath();
            ctx.moveTo(fromX, fromY);
            
            // Add some curve to the connections for visual appeal
            const midX = (fromX + toX) / 2;
            const midY = (fromY + toY) / 2;
            const offset = 20 * camera.zoom;
            ctx.quadraticCurveTo(midX + offset, midY - offset, toX, toY);
            ctx.stroke();
            
            ctx.restore();
        }

        // Draw component node
        function drawComponent(comp) {
            ctx.save();
            
            // Apply camera transformation
            const screenX = (comp.x - camera.x) * camera.zoom + canvas.width / 2;
            const screenY = (comp.y - camera.y) * camera.zoom + canvas.height / 2;
            const scaledSize = comp.size * camera.zoom;
            
            // Skip drawing if component is off screen
            if (screenX < -scaledSize || screenX > canvas.width + scaledSize || 
                screenY < -scaledSize || screenY > canvas.height + scaledSize) {
                ctx.restore();
                return;
            }
            
            // Node glow effect
            const gradient = ctx.createRadialGradient(screenX, screenY, 0, screenX, screenY, scaledSize + 10);
            gradient.addColorStop(0, comp.color + 'ff');
            gradient.addColorStop(0.7, comp.color + '80');
            gradient.addColorStop(1, comp.color + '00');
            
            ctx.fillStyle = gradient;
            ctx.beginPath();
            ctx.arc(screenX, screenY, scaledSize + 10, 0, Math.PI * 2);
            ctx.fill();
            
            // Main node
            ctx.fillStyle = comp.color;
            ctx.beginPath();
            
            // Pulsing animation
            let size = scaledSize;
            if (animationActive) {
                size += Math.sin(frameCount * 0.1 + comp.x * 0.01) * 3 * camera.zoom;
            }
            
            // Highlight selected component
            if (selectedComponent && selectedComponent.id === comp.id) {
                size += 5 * camera.zoom;
                ctx.strokeStyle = '#ffffff';
                ctx.lineWidth = 3 * camera.zoom;
            }
            
            ctx.arc(screenX, screenY, size, 0, Math.PI * 2);
            ctx.fill();
            
            if (selectedComponent && selectedComponent.id === comp.id) {
                ctx.stroke();
            }
            
            // Component labels (only show if zoom is sufficient)
            if (camera.zoom > 0.3) {
                ctx.fillStyle = comp.color;
                ctx.font = `bold ${Math.max(8, 11 * camera.zoom)}px Arial`;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(comp.name, screenX, screenY + scaledSize + 20 * camera.zoom);
                
                // Draw layer label
                ctx.fillStyle = '#94a3b8';
                ctx.font = `${Math.max(6, 9 * camera.zoom)}px Arial`;
                ctx.fillText(comp.layer, screenX, screenY + scaledSize + 35 * camera.zoom);
            }
            
            ctx.restore();
        }

        // Handle mouse interactions
        canvas.addEventListener('mousedown', (event) => {
            isDragging = true;
            lastMouseX = event.clientX;
            lastMouseY = event.clientY;
            canvas.style.cursor = 'grabbing';
        });

        canvas.addEventListener('mousemove', (event) => {
            if (isDragging) {
                const deltaX = event.clientX - lastMouseX;
                const deltaY = event.clientY - lastMouseY;
                
                // Update camera position (invert for intuitive dragging)
                camera.x -= deltaX / camera.zoom;
                camera.y -= deltaY / camera.zoom;
                
                lastMouseX = event.clientX;
                lastMouseY = event.clientY;
            }
        });

        canvas.addEventListener('mouseup', () => {
            isDragging = false;
            canvas.style.cursor = 'crosshair';
        });

        canvas.addEventListener('mouseleave', () => {
            isDragging = false;
            canvas.style.cursor = 'crosshair';
        });

        // Handle mouse clicks for component selection
        canvas.addEventListener('click', (event) => {
            if (isDragging) return; // Don't select if we were dragging
            
            const rect = canvas.getBoundingClientRect();
            const mouseX = event.clientX - rect.left;
            const mouseY = event.clientY - rect.top;
            
            selectedComponent = null;
            
            // Check if click is on any component
            for (const comp of components) {
                // Convert world coordinates to screen coordinates
                const screenX = (comp.x - camera.x) * camera.zoom + canvas.width / 2;
                const screenY = (comp.y - camera.y) * camera.zoom + canvas.height / 2;
                const scaledSize = comp.size * camera.zoom;
                
                const distance = Math.sqrt((mouseX - screenX) ** 2 + (mouseY - screenY) ** 2);
                if (distance <= scaledSize) {
                    selectedComponent = comp;
                    showComponentInfo(comp);
                    break;
                }
            }
            
            if (!selectedComponent) {
                hideComponentInfo();
            }
        });

        // Handle mouse wheel for zooming
        canvas.addEventListener('wheel', (event) => {
            event.preventDefault();
            
            const rect = canvas.getBoundingClientRect();
            const mouseX = event.clientX - rect.left - canvas.width / 2;
            const mouseY = event.clientY - rect.top - canvas.height / 2;
            
            const zoomFactor = event.deltaY > 0 ? 0.9 : 1.1;
            const oldZoom = camera.zoom;
            const newZoom = Math.max(0.1, Math.min(3, camera.zoom * zoomFactor));
            
            if (newZoom !== oldZoom) {
                // Zoom towards mouse position
                const zoomRatio = newZoom / oldZoom;
                camera.x += mouseX / oldZoom * (1 - zoomRatio);
                camera.y += mouseY / oldZoom * (1 - zoomRatio);
                camera.zoom = newZoom;
            }
        });

        // Keyboard navigation
        document.addEventListener('keydown', (event) => {
            const moveSpeed = 50 / camera.zoom;
            
            switch(event.key) {
                case 'ArrowLeft':
                case 'a':
                case 'A':
                    camera.x -= moveSpeed;
                    break;
                case 'ArrowRight':
                case 'd':
                case 'D':
                    camera.x += moveSpeed;
                    break;
                case 'ArrowUp':
                case 'w':
                case 'W':
                    camera.y -= moveSpeed;
                    break;
                case 'ArrowDown':
                case 's':
                case 'S':
                    camera.y += moveSpeed;
                    break;
                case '+':
                case '=':
                    zoomIn();
                    break;
                case '-':
                case '_':
                    zoomOut();
                    break;
                case 'r':
                case 'R':
                    resetLayout();
                    break;
            }
        });

        // Show component information
        function showComponentInfo(comp) {
            const panel = document.getElementById('infoPanel');
            const collapseBtn = document.getElementById('infoCollapseBtn');
            document.getElementById('componentName').textContent = comp.name;
            document.getElementById('componentLayer').textContent = `Layer: ${comp.layer}`;
            document.getElementById('componentDescription').textContent = comp.description;
            panel.classList.add('visible');
            panel.classList.remove('collapsed');
            collapseBtn.style.display = 'block';
        }

        // Hide component information
        function hideComponentInfo() {
            const panel = document.getElementById('infoPanel');
            const collapseBtn = document.getElementById('infoCollapseBtn');
            panel.classList.remove('visible');
            panel.classList.remove('collapsed');
            collapseBtn.style.display = 'none';
        }

        // Toggle functions for collapsible panels
        function toggleControls() {
            const panel = document.getElementById('controlsPanel');
            const btn = panel.querySelector('.collapse-btn');
            panel.classList.toggle('collapsed');
            btn.textContent = panel.classList.contains('collapsed') ? '+' : '−';
        }

        function toggleLegend() {
            const panel = document.getElementById('legendPanel');
            const btn = panel.querySelector('.collapse-btn');
            panel.classList.toggle('collapsed');
            btn.textContent = panel.classList.contains('collapsed') ? '+' : '−';
        }

        function toggleInfo() {
            const panel = document.getElementById('infoPanel');
            const btn = document.getElementById('infoCollapseBtn');
            panel.classList.toggle('collapsed');
            btn.textContent = panel.classList.contains('collapsed') ? '+' : '−';
        }

        // Update stats
        function updateStats() {
            const zoomLevel = Math.round(camera.zoom * 100);
            document.getElementById('stats').innerHTML = `
                <div>Components: <span id="nodeCount">${components.length}</span></div>
                <div>Connections: <span id="connectionCount">${connections.length}</span></div>
                <div>Active Flows: <span id="flowCount">${showDataFlow ? connections.length : 0}</span></div>
                <div>Zoom: <span>${zoomLevel}%</span></div>
            `;
        }

        // Main animation loop
        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw connections first (behind nodes)
            connections.forEach(conn => {
                drawConnection(conn.from, conn.to, conn.type, showDataFlow);
            });
            
            // Draw components
            components.forEach(comp => {
                drawComponent(comp);
            });
            
            // Update stats periodically
            if (frameCount % 60 === 0) {
                updateStats();
            }
            
            frameCount++;
            requestAnimationFrame(animate);
        }

        // Control functions
        function toggleAnimation() {
            animationActive = !animationActive;
        }

        function resetLayout() {
            camera.x = 0;
            camera.y = 0;
            camera.zoom = 1;
            selectedComponent = null;
            hideComponentInfo();
        }

        function toggleDataFlow() {
            showDataFlow = !showDataFlow;
        }

        function focusLayer() {
            // Focus on AI Agents layer
            camera.x = 0;
            camera.y = -25;
            camera.zoom = 1.5;
            
            const aiAgents = components.filter(comp => comp.layer === 'AI Agents');
            if (aiAgents.length > 0) {
                selectedComponent = aiAgents[0];
                showComponentInfo(aiAgents[0]);
            }
        }

        function zoomIn() {
            const oldZoom = camera.zoom;
            camera.zoom = Math.min(3, camera.zoom * 1.2);
        }

        function zoomOut() {
            const oldZoom = camera.zoom;
            camera.zoom = Math.max(0.1, camera.zoom / 1.2);
        }

        // Initialize
        createBackgroundParticles();
        updateStats();
        animate();

        // Show initial info
        setTimeout(() => {
            document.getElementById('infoPanel').classList.add('visible');
        }, 1000);

        // Google Analytics (optional)
        // Uncomment and replace GA_MEASUREMENT_ID with your actual ID
        /*
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'GA_MEASUREMENT_ID');
        */
    </script>

    <!-- Google Analytics (optional) -->
    <!-- Uncomment and replace GA_MEASUREMENT_ID with your actual ID
    <script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
    -->
</body>
</html>